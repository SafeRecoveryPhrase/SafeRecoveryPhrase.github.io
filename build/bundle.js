var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let i=!1;const a=new Set;function u(t,e){i&&a.delete(e),e.parentNode!==t&&t.appendChild(e)}function l(t,e,n){i&&a.delete(e),(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}function s(t){i?a.add(t):t.parentNode&&t.parentNode.removeChild(t)}function d(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function p(){return f(" ")}function h(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function y(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function m(t,e){t.value=null==e?"":e}let b;function g(t){b=t}const $=[],x=[],w=[],v=[],C=Promise.resolve();let _=!1;function E(t){w.push(t)}let k=!1;const A=new Set;function S(){if(!k){k=!0;do{for(let t=0;t<$.length;t+=1){const e=$[t];g(e),j(e.$$)}for(g(null),$.length=0;x.length;)x.pop()();for(let t=0;t<w.length;t+=1){const e=w[t];A.has(e)||(A.add(e),e())}w.length=0}while($.length);for(;v.length;)v.pop()();_=!1,k=!1,A.clear()}}function j(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(E)}}const D=new Set;function N(t,e){-1===t.$$.dirty[0]&&($.push(t),_||(_=!0,C.then(S)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function R(c,u,l,d,f,p,h=[-1]){const y=b;g(c);const m=c.$$={fragment:null,ctx:null,props:p,update:t,not_equal:f,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(y?y.$$.context:u.context||[]),callbacks:n(),dirty:h,skip_bound:!1};let $=!1;if(m.ctx=l?l(c,u.props||{},((t,e,...n)=>{const o=n.length?n[0]:e;return m.ctx&&f(m.ctx[t],m.ctx[t]=o)&&(!m.skip_bound&&m.bound[t]&&m.bound[t](o),$&&N(c,t)),e})):[],m.update(),$=!0,o(m.before_update),m.fragment=!!d&&d(m.ctx),u.target){if(u.hydrate){i=!0;const t=function(t){return Array.from(t.childNodes)}(u.target);m.fragment&&m.fragment.l(t),t.forEach(s)}else m.fragment&&m.fragment.c();u.intro&&((x=c.$$.fragment)&&x.i&&(D.delete(x),x.i(w))),function(t,n,c,i){const{fragment:a,on_mount:u,on_destroy:l,after_update:s}=t.$$;a&&a.m(n,c),i||E((()=>{const n=u.map(e).filter(r);l?l.push(...n):o(n),t.$$.on_mount=[]})),s.forEach(E)}(c,u.target,u.anchor,u.customElement),function(){i=!1;for(const t of a)t.parentNode.removeChild(t);a.clear()}(),S()}var x,w;g(y)}function T(t){let e,n,r,c,i,a,u,f,b,g,$,x,w,v,C,_,E,k,A,S,j;return{c(){e=d("h2"),e.textContent="Descifrar",n=p(),r=d("h3"),r.textContent="Datos cifrados",c=p(),i=d("p"),i.textContent="Selecciona el fichero o pega el texto.",a=p(),u=d("textarea"),f=p(),b=d("button"),b.textContent="Selecciona el fichero",g=p(),$=d("h3"),$.textContent="Frase de cifrado:",x=p(),w=d("input"),v=p(),C=d("button"),C.textContent="Descifrar",_=p(),E=d("h3"),E.textContent="Datos descifrados",k=p(),A=d("textarea"),y(w,"type","text"),A.disabled="true"},m(o,s){l(o,e,s),l(o,n,s),l(o,r,s),l(o,c,s),l(o,i,s),l(o,a,s),l(o,u,s),m(u,t[4]),l(o,f,s),l(o,b,s),l(o,g,s),l(o,$,s),l(o,x,s),l(o,w,s),m(w,t[1]),l(o,v,s),l(o,C,s),l(o,_,s),l(o,E,s),l(o,k,s),l(o,A,s),m(A,t[3]),S||(j=[h(u,"input",t[17]),h(w,"input",t[18]),h(C,"click",t[8]),h(A,"input",t[19])],S=!0)},p(t,e){16&e&&m(u,t[4]),2&e&&w.value!==t[1]&&m(w,t[1]),8&e&&m(A,t[3])},d(t){t&&s(e),t&&s(n),t&&s(r),t&&s(c),t&&s(i),t&&s(a),t&&s(u),t&&s(f),t&&s(b),t&&s(g),t&&s($),t&&s(x),t&&s(w),t&&s(v),t&&s(C),t&&s(_),t&&s(E),t&&s(k),t&&s(A),S=!1,o(j)}}}function U(t){let e,n,r,c,i,a,b,g,$,x,w,v,C,_,E,k;return{c(){e=d("h2"),e.textContent="Cifrar",n=p(),r=d("h3"),r.textContent="Frase de cifrado:",c=p(),i=d("input"),a=p(),b=d("h3"),b.textContent="Texto a cifrar:",g=p(),$=d("textarea"),w=p(),v=d("button"),C=f("Descargar fichero cifrado"),y(i,"type","text"),$.disabled=x=!t[2],y($,"maxlength","446"),v.disabled=_=!t[1]||!t[5]},m(o,s){l(o,e,s),l(o,n,s),l(o,r,s),l(o,c,s),l(o,i,s),m(i,t[1]),l(o,a,s),l(o,b,s),l(o,g,s),l(o,$,s),m($,t[5]),l(o,w,s),l(o,v,s),u(v,C),E||(k=[h(i,"input",t[15]),h(i,"input",t[6]),h($,"input",t[16]),h($,"input",t[7]),h(v,"click",t[9])],E=!0)},p(t,e){2&e&&i.value!==t[1]&&m(i,t[1]),4&e&&x!==(x=!t[2])&&($.disabled=x),32&e&&m($,t[5]),34&e&&_!==(_=!t[1]||!t[5])&&(v.disabled=_)},d(t){t&&s(e),t&&s(n),t&&s(r),t&&s(c),t&&s(i),t&&s(a),t&&s(b),t&&s(g),t&&s($),t&&s(w),t&&s(v),E=!1,o(k)}}}function L(e){let n,r,c,i,a,f,m,b,g,$,x;function w(t,e){return"encrypt"===t[0]?U:"decrypt"===t[0]?T:void 0}let v=w(e),C=v&&v(e);return{c(){n=d("main"),r=d("h1"),r.textContent="Web AES",c=p(),i=d("nav"),a=d("ul"),f=d("li"),f.textContent="Cifrar",m=p(),b=d("li"),b.textContent="Descifrar",g=p(),C&&C.c(),y(r,"class","svelte-qaqniu"),y(n,"class","svelte-qaqniu")},m(t,o){l(t,n,o),u(n,r),u(n,c),u(n,i),u(i,a),u(a,f),u(a,m),u(a,b),u(n,g),C&&C.m(n,null),$||(x=[h(f,"click",e[13]),h(b,"click",e[14])],$=!0)},p(t,[e]){v===(v=w(t))&&C?C.p(t,e):(C&&C.d(1),C=v&&v(t),C&&(C.c(),C.m(n,null)))},i:t,o:t,d(t){t&&s(n),C&&C.d(),$=!1,o(x)}}}function O(t){let e="";const n=new Uint8Array(t),o=n.byteLength;for(let t=0;t<o;t++)e+=String.fromCharCode(n[t]);return btoa(e)}function q(t){const e=atob(t),n=e.length,o=new Uint8Array(n);for(let t=0;t<n;t++)o[t]=e.charCodeAt(t);return o.buffer}function B(t,e,n){let o,r,c,i,a,u,l,s="encrypt",d="";async function f(){const t=d+"=".repeat(446-d.length),e=(new TextEncoder).encode(t);n(10,c=crypto.getRandomValues(new Uint8Array(16)));try{n(11,i=await window.crypto.subtle.encrypt({name:"AES-CTR",counter:c,length:64},r,e))}catch(t){console.error(t)}}return t.$$.update=()=>{7168&t.$$.dirty&&c&&(n(12,a={counter:O(c),encrypted:O(i)}),n(4,l=JSON.stringify(a)))},[s,o,r,u,l,d,async function(){n(2,r=await window.crypto.subtle.deriveKey({name:"PBKDF2",salt:crypto.getRandomValues(new Uint8Array(16)),iterations:1e5,hash:"SHA-512"},await function(){let t=(new TextEncoder).encode(o);return window.crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveBits","deriveKey"])}(),{name:"AES-CTR",length:256},!0,["encrypt","decrypt"])),f()},f,async function(){const t=new TextDecoder,e=JSON.parse(l),o=q(e.counter),c=q(e.encrypted);try{const e=await window.crypto.subtle.decrypt({name:"AES-CTR",counter:o,length:64},r,c),i=t.decode(e);n(3,u=i.replace(/=+$/,""))}catch(t){console.error(t)}},function(){const t=new Blob([l],{type:"application/json"}),e=document.createElement("a");e.style.display="none",e.download="encrypted.json",e.href=URL.createObjectURL(t),e.dataset.downloadurl=["application/json",e.download,e.href].join(":"),document.body.appendChild(e),e.click(),document.body.removeChild(e),setTimeout((function(){URL.revokeObjectURL(e.href)}),1500)},c,i,a,()=>n(0,s="encrypt"),()=>n(0,s="decrypt"),function(){o=this.value,n(1,o)},function(){d=this.value,n(5,d)},function(){l=this.value,n(4,l),n(10,c),n(11,i),n(12,a)},function(){o=this.value,n(1,o)},function(){u=this.value,n(3,u)}]}return new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),R(this,t,B,L,c,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
